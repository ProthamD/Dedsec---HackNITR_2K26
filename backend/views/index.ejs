<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Inventree - AI Inventory Manager</title>
    <script src="https://cdn.jsdelivr.net/npm/@tailwindcss/browser@4"></script>
    <script src="https://unpkg.com/feather-icons"></script>
    <style>
        :root {
            --bg-primary: hsl(240, 6%, 10%);
            --bg-card: hsl(240, 5%, 12%);
            --border: hsl(240, 4%, 20%);
            --text-primary: hsl(0, 0%, 98%);
            --text-muted: hsl(240, 5%, 64%);
            --accent-green: hsl(142, 70%, 45%);
            --chat-user: hsl(240, 4%, 18%);
            --chat-ai: hsl(240, 5%, 14%);
        }
        body { background: var(--bg-primary); color: var(--text-primary); }
        .gradient-mesh {
            background: radial-gradient(at 40% 20%, hsla(142, 70%, 45%, 0.1) 0px, transparent 50%),
                        radial-gradient(at 80% 0%, hsla(240, 5%, 20%, 0.5) 0px, transparent 50%),
                        radial-gradient(at 0% 50%, hsla(142, 70%, 45%, 0.05) 0px, transparent 50%);
        }
    </style>
</head>
<body class="min-h-screen">
    <% if (!hasInventory) { %>
        <!-- No Inventory State -->
        <div class="flex items-center justify-center min-h-screen px-4">
            <div class="text-center">
                <div class="text-6xl mb-4">ðŸ“¦</div>
                <h2 class="text-2xl font-semibold mb-2" style="color: var(--text-primary);">No Inventory Data</h2>
                <p class="mb-6" style="color: var(--text-muted);">Add inventory items to get started</p>
                <a href="/inventory/add" class="inline-flex items-center px-6 py-3 rounded-lg font-medium transition-colors" style="background: var(--accent-green); color: var(--text-primary);">
                    Add Inventory
                </a>
            </div>
        </div>
    <% } else { %>
        <!-- Hero Header -->
        <section class="flex flex-col items-center justify-center px-4 py-12 gradient-mesh relative">
            <!-- Background Decoration -->
            <div class="absolute inset-0 overflow-hidden pointer-events-none">
                <div class="absolute top-20 left-10 w-72 h-72 rounded-full blur-3xl" style="background: hsla(142, 70%, 45%, 0.05);"></div>
                <div class="absolute bottom-20 right-10 w-96 h-96 rounded-full blur-3xl" style="background: hsla(142, 70%, 45%, 0.03);"></div>
            </div>

            <!-- Header -->
            <div class="text-center relative z-10">
                <h1 class="text-5xl md:text-6xl lg:text-7xl font-bold mb-4">
                    <span style="color: var(--text-primary);">Inven</span><span style="color: var(--accent-green);">tree</span>
                </h1>
                <p class="text-xl md:text-2xl mb-6" style="color: var(--text-muted);">
                    Inventory Management
                </p>
                <div class="inline-flex items-center gap-2 px-4 py-2 rounded-full" style="background: hsla(240, 5%, 12%, 0.5); border: 1px solid var(--border);">
                    <span class="text-sm" style="color: var(--accent-green);">âœ¨</span>
                    <span class="text-sm" style="color: var(--text-muted);">AI-Powered Assistant</span>
                </div>
            </div>
        </section>

        <!-- Management Center Section -->
        <% if (hasInventory) { %>
            <%- include('management', { issues: issues, issueCount: issueCount, inventoryCount: inventoryCount }) %>
        <% } %>

        <!-- Chat Section -->
        <section class="flex flex-col items-center justify-center px-4 py-8" style="border-top: 1px solid var(--border);">
            <!-- Chat Container -->
            <div class="w-full max-w-3xl relative z-10">
                <div class="rounded-2xl shadow-2xl overflow-hidden" style="background: hsla(240, 5%, 12%, 0.8); backdrop-filter: blur(24px); border: 1px solid var(--border);">
                    <!-- Chat Messages -->
                    <div id="chatMessages" class="h-[300px] overflow-y-auto p-6 space-y-4">
                        <!-- Bot Welcome Message -->
                        <div class="flex gap-3">
                            <div class="w-8 h-8 rounded-lg flex items-center justify-center shrink-0" style="background: var(--chat-ai);">
                                <svg class="w-4 h-4" style="color: var(--text-muted);" fill="currentColor" viewBox="0 0 20 20">
                                    <path d="M13 7H7v6h6V7z"/>
                                    <path fill-rule="evenodd" d="M7 2a1 1 0 012 0v1h2V2a1 1 0 112 0v1h2a2 2 0 012 2v2h1a1 1 0 110 2h-1v2h1a1 1 0 110 2h-1v2a2 2 0 01-2 2h-2v1a1 1 0 11-2 0v-1H9v1a1 1 0 11-2 0v-1H5a2 2 0 01-2-2v-2H2a1 1 0 110-2h1V9H2a1 1 0 010-2h1V5a2 2 0 012-2h2V2zM5 5h10v10H5V5z" clip-rule="evenodd"/>
                                </svg>
                            </div>
                            <div class="px-4 py-3 rounded-2xl rounded-bl-md max-w-[80%]" style="background: var(--chat-ai);">
                                <p class="text-sm leading-relaxed" style="color: var(--text-primary);">
                                    Hello! I'm your Inventory AI Assistant. I can help you manage stock levels, track items, reduce waste, and automate inventory tasks. What would you like to do today?
                                </p>
                            </div>
                        </div>
                    </div>

                    <!-- Input Area -->
                    <div class="p-4" style="border-top: 1px solid var(--border);">
                        <div class="flex gap-3">
                            <input 
                                type="text" 
                                id="messageInput" 
                                placeholder="Ask about inventory, stock levels, or automation..."
                                onkeypress="handleKeyPress(event)"
                                class="flex-1 px-4 py-3 rounded-lg text-sm focus:outline-none" 
                                style="background: hsla(240, 5%, 12%, 0.5); border: 1px solid var(--border); color: var(--text-primary);"
                            >
                            <button 
                                onclick="sendMessage()" 
                                id="sendBtn"
                                class="p-3 rounded-lg transition-all"
                                style="background: var(--accent-green); color: var(--text-primary); box-shadow: 0 0 20px hsla(142, 70%, 45%, 0.3);"
                            >
                                <svg class="w-4 h-4" fill="currentColor" viewBox="0 0 20 20">
                                    <path d="M10.894 2.553a1 1 0 00-1.788 0l-7 14a1 1 0 001.169 1.409l5-1.429A1 1 0 009 15.571V11a1 1 0 112 0v4.571a1 1 0 00.725.962l5 1.428a1 1 0 001.17-1.408l-7-14z" />
                                </svg>
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- Hidden input for userId -->
        <input type="hidden" id="userId" value="<%= userId %>">
    <% } %>

    <script src="/js/chat.js"></script>
</body>
</html>
